<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ó–∞–≤–æ–¥–ê–Ω–∞–ª–∏—Ç–∏–∫—Å - –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –∂—É—Ä–Ω–∞–ª–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π">
    <meta name="theme-color" content="#2563eb">
    <title>–ó–∞–≤–æ–¥–ê–Ω–∞–ª–∏—Ç–∏–∫—Å - –ê–Ω–∞–ª–∏–∑ –∂—É—Ä–Ω–∞–ª–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞</title>
    
    <!-- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="libs/react.production.min.js" as="script">
    <link rel="preload" href="libs/react-dom.production.min.js" as="script">
    <link rel="preload" href="utils.js" as="script">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè≠</text></svg>">
</head>
<body>
    <!-- –ö–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è React -->
    <div id="root">
        <div class="loading-screen">
            <div class="loading-spinner"></div>
            <p class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</p>
        </div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—à–∏–±–æ–∫ -->
    <div id="error" class="error-container" style="display:none">
        <div class="error-content">
            <div class="error-header">
                <svg class="error-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                </svg>
                <h3 class="error-title">–û—à–∏–±–∫–∞</h3>
                <button class="error-close" onclick="this.parentElement.parentElement.parentElement.style.display='none'">√ó</button>
            </div>
            <div class="error-message"></div>
            <div class="error-details" style="display:none"></div>
        </div>
    </div>
    
    <!-- –õ–æ–∫–∞–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script src="libs/react.production.min.js"></script>
    <script src="libs/react-dom.production.min.js"></script>
    <script src="libs/Recharts.js"></script>
    <script src="libs/lucide.min.js"></script>
    <script src="libs/babel.min.js"></script>
    
    <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è -->
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞:', { message, source, lineno, colno, error });
            showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏', error?.message || message);
            return false;
        };

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –ø—Ä–æ–º–∏—Å–æ–≤
        window.onunhandledrejection = function(event) {
            console.error('–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–∏—Å–∞:', event.reason);
            showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏', event.reason?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
        };

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫
        function showError(title, message, details) {
            const errorContainer = document.getElementById('error');
            const errorTitle = errorContainer.querySelector('.error-title');
            const errorMessage = errorContainer.querySelector('.error-message');
            const errorDetails = errorContainer.querySelector('.error-details');
            
            errorTitle.textContent = title;
            errorMessage.textContent = message;
            
            if (details) {
                errorDetails.textContent = details;
                errorDetails.style.display = 'block';
            } else {
                errorDetails.style.display = 'none';
            }
            
            errorContainer.style.display = 'block';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫
        function checkLibraries() {
            const requiredLibs = {
                'React': window.React,
                'ReactDOM': window.ReactDOM,
                'Recharts': window.Recharts,
                'lucide': window.lucide,
                'Babel': window.Babel
            };
            
            console.log('–°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫:', requiredLibs);
            
            const missingLibs = Object.entries(requiredLibs)
                .filter(([_, lib]) => !lib)
                .map(([name]) => name);
            
            if (missingLibs.length > 0) {
                throw new Error(
                    `–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:\n` +
                    missingLibs.map(lib => `- ${lib}`).join('\n') +
                    `\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ libs/`
                );
            }
            
            return true;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.initApp = function() {
            try {
                console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫
                checkLibraries();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∫–æ–Ω–æ–∫
                if (window.lucide?.createIcons) {
                    window.lucide.createIcons();
                }
                
                console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                showError('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏', error.message);
                throw error; // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ
            }
        };
    </script>
    
    <!-- –£—Ç–∏–ª–∏—Ç—ã -->
    <script src="utils.js"></script>
    
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script type="text/babel" data-presets="react" src="components/Dashboard.js"></script>
    <script type="text/babel" data-presets="react" src="components/LogViewer.js"></script>
    <script type="text/babel" data-presets="react" src="components/Analytics.js"></script>
    <script type="text/babel" data-presets="react" src="components/Settings.js"></script>
    <script type="text/babel" data-presets="react" src="app.js"></script>
    
    <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            try {
                window.initApp();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                showError('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏', error.message);
            }
        });
    </script>
</body>
</html>
